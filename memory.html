<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Memory Match — Games</title>
  <link rel="stylesheet" href="porfolio.css">
  <style>
    .game-page { max-width: 920px; margin: 36px auto; padding: 18px; }
    .game-board { display:grid; gap:10px; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); }
    .card { perspective: 800px; }
    .card-inner { position:relative; width:100%; padding-top:100%; transform-style: preserve-3d; transition: transform 300ms; }
    .card.flipped .card-inner { transform: rotateY(180deg); }
    .card-face { position:absolute; inset:0; backface-visibility: hidden; border-radius:8px; overflow:hidden; display:flex; align-items:center; justify-content:center; }
    .card-back { background:linear-gradient(135deg,#f0f0f0,#e6e6e6); font-size:28px; color:#666; }
    .card-front { transform: rotateY(180deg); background:#fff; border:1px solid var(--border); }
    .card-front img { width:100%; height:100%; object-fit:cover; }
    .controls { margin:12px 0; display:flex; gap:8px; align-items:center; }
    .status { margin-left:auto; color:var(--muted); }
  </style>
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand">
        <div class="brand-badge" aria-hidden="true">TH</div>
        <div class="brand-text">
          <strong>THET HTAR SANN</strong>
          <span class="note">Games</span>
        </div>
      </div>
      <div style="margin-left:auto;display:flex;gap:8px;align-items:center;">
        <a class="cta" href="games.html">Back to Games</a>
        <a class="cta" href="porfolio.html">Back to Portfolio</a>
      </div>
    </div>
  </header>

  <main class="game-page">
    <h2>Memory Match</h2>
    <p class="subtitle">Flip cards and match pairs. Find all pairs as fast as you can.</p>

    <div class="controls">
      <label for="pairCount">Pairs:</label>
      <select id="pairCount" style="margin-left:8px;padding:6px;border-radius:6px;border:1px solid var(--border);">
        <option value="4">4</option>
        <option value="6">6</option>
        <option value="8" selected>8</option>
        <option value="10">10</option>
      </select>
      <button id="restartBtn" class="cta cta-primary">Restart</button>
      <div class="status">
        <span id="moves">Moves: 0</span> • <span id="matches">Matches: 0</span> • <span id="timer">Time: 0s</span>
      </div>
    </div>

    <div id="board" class="game-board"></div>
  </main>

  <script>
    (function(){
      const imageFiles = [
        'andriod.webp','c++.webp','copilot.webp','csharp.webp','css.jpg','html.jpg','java.jpg','js.jpg','php.jpg','python.webp','react.jpg'
      ];
      const basePath = 'images/games/memory match/';

      const boardEl = document.getElementById('board');
      const movesEl = document.getElementById('moves');
      const matchesEl = document.getElementById('matches');
      const timerEl = document.getElementById('timer');
      const restartBtn = document.getElementById('restartBtn');
      const pairCountSelect = document.getElementById('pairCount');

      let firstCard = null;
      let secondCard = null;
      let lockBoard = false;
      let moves = 0;
      let matches = 0;
      let totalPairs = 8;
      let timer = null;
      let startTime = null;

      function shuffle(array){
        for(let i=array.length-1;i>0;i--){
          const j = Math.floor(Math.random()*(i+1));
          [array[i],array[j]] = [array[j],array[i]];
        }
      }

      function buildBoard(){
        stopTimer();
        boardEl.innerHTML = '';
        moves = 0; matches = 0; firstCard = null; secondCard = null; lockBoard = false;
        movesEl.textContent = 'Moves: 0';
        matchesEl.textContent = 'Matches: 0';
        timerEl.textContent = 'Time: 0s';

        totalPairs = Math.min(parseInt(pairCountSelect.value,10), imageFiles.length);
        const chosen = imageFiles.slice(0, totalPairs);
        const pairList = chosen.concat(chosen);
        shuffle(pairList);

        pairList.forEach((img, idx) => {
          const card = document.createElement('div');
          card.className = 'card';
          card.dataset.image = img;
          const inner = document.createElement('div');
          inner.className = 'card-inner';
          const back = document.createElement('div'); back.className = 'card-face card-back'; back.textContent = '❓';
          const front = document.createElement('div'); front.className = 'card-face card-front';
          const image = document.createElement('img'); image.src = basePath + img; image.alt = '';
          front.appendChild(image);
          inner.appendChild(back); inner.appendChild(front);
          card.appendChild(inner);
          card.addEventListener('click', onCardClick);
          boardEl.appendChild(card);
        });
      }

      function onCardClick(e){
        if (lockBoard) return;
        const card = e.currentTarget;
        if (card === firstCard) return;
        card.classList.add('flipped');
        if (!startTime) startTimer();
        if (!firstCard){
          firstCard = card; return;
        }
        secondCard = card;
        moves++;
        movesEl.textContent = 'Moves: ' + moves;
        checkForMatch();
      }

      function checkForMatch(){
        const isMatch = firstCard.dataset.image === secondCard.dataset.image;
        if (isMatch){
          matches++; matchesEl.textContent = 'Matches: ' + matches;
          firstCard.removeEventListener('click', onCardClick);
          secondCard.removeEventListener('click', onCardClick);
          resetSelection();
          if (matches === totalPairs) gameWon();
        } else {
          lockBoard = true;
          setTimeout(()=>{
            firstCard.classList.remove('flipped');
            secondCard.classList.remove('flipped');
            resetSelection();
            lockBoard = false;
          }, 800);
        }
      }

      function resetSelection(){ firstCard = null; secondCard = null; }

      function startTimer(){ startTime = Date.now(); timer = setInterval(()=>{
        const elapsed = Math.floor((Date.now()-startTime)/1000);
        timerEl.textContent = 'Time: ' + elapsed + 's';
      },1000); }

      function stopTimer(){ if (timer) clearInterval(timer); timer = null; startTime = null; }

      function gameWon(){ stopTimer(); alert('You found all pairs! Moves: ' + moves + ', ' + timerEl.textContent); }

      restartBtn.addEventListener('click', buildBoard);
      pairCountSelect.addEventListener('change', buildBoard);

      // init
      buildBoard();
    })();
  </script>
</body>
</html>
